# Ресурс "Источники" (sources)

Источники содержит записи о всех возможных источниках контента в системе. Основная задача ресурса - выдать по строковому
полю `who` информацию об источнике.

## 1. Список Источников

**Назначение:**   для получения списка Источников.

**Запрос:** `/api/v2/sources/list`

**Тип запроса:**  POST

**Параметры тела запроса:**

| **имя поля**  | **тип**    | **описание**                                                          |
|---------------|------------|-----------------------------------------------------------------------|
| `who`         | `[]string` | массив идентификатров Источников для выдачи                           | 
| `lid`         | `[]uuid`   | массив идентификатров Линков для выдачи                               | 
| `svcid`       | `[]string` | массив идентификатров Сервисов для выдачи                             | 
| `updatedFrom` | `unixtime` | время начала обновления записи о Источнике                            | 
| `updatedTo`   | `unixtime` | время окончания обновления записи о Источнике                         |
| `order`       | `[]string` | устанавливает сортировку выдачи списка. Возможные значения в массиве: | 
| `-who`        | `opt`      | сортировка по ID Источники                                            | 
| `-svcid`      | `opt`      | сортировка по наименованию Сервиса                                    | 
| `-caption`    | `opt`      | сортировка по заголовку Источники                                     | 
| `-created`    | `opt`      | сортировка по времени создания записи об Источники                    | 
| `-updated`    | `opt`      | сортировка по времени обновления записи об Источники                  |  
| `orderDir`    | `string`   | устанавливает направление сортировки выдачи списка. `asc` или `desc`  | 

**Тело запроса:**

```json
{
  "who": [
    "6016ebf8-81a3-11e7-bb31-be2e44b06b34",
    "prsstrip"
  ],
  "svcid": [
    "drvcomm"
  ],
  "lid": [
    "ee413b33-8660-42be-84cb-3c92fc81134f"
  ]
}
```

**Примеры:**  `/api/v2/sources/list`

**Ответ:**

```json
{
  "meta": {
    "code": 200,
    "rid": "058e6b2d-a3b6-11ed-a80b-02420a00015b",
    "time": "5.909"
  },
  "response": {
    "info": {
      "page": 0,
      "pagecount": 1,
      "pagesize": 100,
      "total": 4
    },
    "sources": [
      {
        "caption": "sample source 1",
        "who": "a7fb3ae9-806a-11ed-a408-02420a00063a",
        "svcid": "datacomm",
        "lid": "a7fb3ae9-806a-11ed-a408-02420a00063a",
        "created": 1671543109,
        "updated": 1671548483
      },
      {
        "caption": "sample source 2",
        "who": "a7fb3ae9-806a-11ed-a408-02420a00063a",
        "svcid": "prsstrip",
        "lid": "",
        "created": 1671543109,
        "updated": 1671548483
      }
    ]
  }
}

```

**Поля ответа:**

| **имя поля** | **тип**    | **описание**                              |
|--------------|------------|-------------------------------------------|
| `who`        | `string`   | уникальный идентификатор записи Источника |
| `caption`    | `string`   | название Источника                        |
| `svcid`      | `string`   | идентификатор сервиса Источника           |
| `lid`        | `string`   | идентификатор линка Источника             |
| `created`    | `unixtime` | Unix время даты создания                  |
| `updated`    | `unixtime` | Unix время даты обновления                |

## 2. Информация по Источнику

**Назначение:**   Получение полной информации о Источнике

**Запрос:** `/api/v2/sources/:who`

**Тип запроса:** GET

**Возможные параметры**:

**Примеры:**

* `/api/v2/sources/a7fb3ae9-806a-11ed-a408-02420a00063a`
* `/api/v2/sources/prsstip`

**Ответ:**

```json

{
  "meta": {
    "code": 200,
    "rid": "865a50a4-a3bb-11ed-a80b-02420a00015b",
    "time": "6.978"
  },
  "response": {
    "source": {
      "caption": "sample source1",
      "who": "a7fb3ae9-806a-11ed-a408-02420a00063a",
      "svcid": "datacomm",
      "lid": "a7fb3ae9-806a-11ed-a408-02420a00063a",
      "created": 1671543109,
      "updated": 1671548483
    }
  }
}

```

**Поля ответа:**

| **имя поля** | **тип**    | **описание**                              |
|--------------|------------|-------------------------------------------|
| `who`        | `string`   | уникальный идентификатор записи Источника |
| `caption`    | `string`   | название записи Источники                 |
| `svcid`      | `string`   | идентификатор сервиса Источника           |
| `lid`        | `string`   | идентификатор линка Источника             |
| `created`    | `unixtime` | Unix время даты создания                  |
| `updated`    | `unixtime` | Unix время даты обновления                |

## 3. Добавить Источник

**Назначение:**   для добавления нового Источника.

**Запрос:** `/api/v2/sources/new`

**Тип запроса:** POST

**Тело запроса**:

```json

{
  "caption": "sample source1",
  "who": "a7fb3ae9-806a-11ed-a408-02420a00063a",
  "svcid": "datacomm",
  "lid": "a7fb3ae9-806a-11ed-a408-02420a00063a"
}

```

**Обязательные поля запроса**:

| **имя поля** | **тип**  | **описание**                              |
|--------------|----------|-------------------------------------------|
| `caption`    | `string` | уникальное имя Источника                  |
| `who`        | `string` | уникальный идентификатор записи Источника |

**Необязательные поля запроса**:

| **имя поля** | **тип**  | **описание**                    |
|--------------|----------|---------------------------------|
| `svcid`      | `string` | идентификатор сервиса Источника |
| `lid`        | `string` | идентификатор линка Источника   |

**Ответ:**

```json

{
  "meta": {},
  "response": {
    "who": "e18a3dc0-704b-11e7-8cf7-a6006ad3dba0"
  }
}

```

**Поля ответа:**

| **имя поля** | **тип**  | **описание**                               |
|--------------|----------|--------------------------------------------|
| `who`        | `string` | уникальный идентификатор записи Источника. |

## 4. Обновить Источник

**Назначение:**   для обновления параметров записи Источники.

**Запрос:** `/api/v2/sources/:who/update`

**Возможные параметры**: нет

**Тип запроса:** POST

**Пример:**

`/api/v2/sources/c4527e88-6fe3-11e7-b6d0-a6006ad3dba0/update`

**Тело запроса: **

```json

{
  "caption": "sample source1",
  "svcid": "datacomm",
  "lid": "a7fb3ae9-806a-11ed-a408-02420a00063a"
}

```

Поле `who` Источника изменить нельзя

**Возможные поля запроса**:

| **имя поля** | **тип**  | **описание**                    |
|--------------|----------|---------------------------------|
| `caption`    | `string` | название записи Источники       |
| `svcid`      | `string` | идентификатор сервиса Источника |
| `lid`        | `string` | идентификатор линка Источника   |

**Ответ:**

```json

{
  "meta": {},
  "response": {}
}

```

## 5. Удалить Источник

**Назначение:** для удаления записи из Источника

**Запрос** `/api/v2/sources/:who/remove`

где `:who` – идентификатор записи

**Тип запроса:** POST

**Пример:**  `/api/v2/sources/dea50f0c-f55f-4063-9f17-e45ae8c03bce/remove

**Ответ:**

```json

{}

```