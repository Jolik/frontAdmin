# 2.Ресурс «Источники» (sources)

## 11.Получить наблюдения указанного источника

**Назначение:** для получения наблюдений конкретного источника.

**Запрос** `/api/v2/sources/SOURCE_ID/observations`

где `SOURCE_ID` – идентификатор источника,

**Возможные параметры:**

| **имя поля**      | **тип**    | **описание**                                                                                                                                                                                                                                                                                                                                                    |
|-------------------|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `seasons`         | `[]string` | список идентификаторов сезонов через запятую                                                                                                                                                                                                                                                                                                                    |
| `lastAt`          | `unixtime` | окончание временного диапазона для `lastdata`. Когда указывается, в качестве `lastdata` выдается последнее значение в ряде для `lastAt`. Если не указан, то принимается как `now` и `lastdata` содержит последнюю точку ряда.                                                                                                                                   |
| `lastNewer`       | `int`      | глубина поиска для `lastdata` в часах. Когда указывается, перекрывает параметр `last_data_newer` из конфига ядра.                                                                                                                                                                                                                                               |
| `dataseries=true` |            | возможный параметр. Если он true - в ответ будут вставлены как **типы** временных рядов (с указанием типа по умолчанию), так и описания **экземпляров** временных рядов по каждому типу с указанием группы ряда. Если параметр false или его нет, то выдаются только список наблюдений и **типов** рядов наблюдений для источника с указанием типа по умолчанию |
| `flag `           |            | список параметров выдачи через запятую. Возможные значения:                                                                                                                                                                                                                                                                                                     |
| `-all   `         | `opt`      | отображать все временные ряды, включая архивные                                                                                                                                                                                                                                                                                                                 |
| `-archiveonly`    | `opt`      | отображать только архивные ряды                                                                                                                                                                                                                                                                                                                                 |
| `-lastdata`       | `opt`      | выводить последнее значение ряда                                                                                                                                                                                                                                                                                                                                |
| `-state`          | `opt`      | выводить статус ряда                                                                                                                                                                                                                                                                                                                                            |

**Тип запроса:** GET

**Примеры:**

* `/api/v2/sources/0001-012345-000/observations?dataseries=true&flag=archiveonly`
* `/api/v2/sources/0001-012345-000/observations`

**Ответ:** :

```json

{
    "meta": {},
    "response": {
        "observations": {
            "count": 25,
            "items": [
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Температура точки росы, мгн., на 2м",
                                "dstid": "ATM-AIR-DWPT-IXXXXXP002M",
                                "name": "Температура точки росы, мгновенное, на высоте 2м",
                                "uid": "1-02-23"
                            }
                        ]
                    },
                    "name": "Температура точки росы",
                    "oid": "ATM-AIR-DWPT"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "per": {
                                        "k": "MIN",
                                        "v": -10
                                    },
                                    "sig": {
                                        "k": "MEAN"
                                    }
                                },
                                "caption": "Отн. вл. возд., ср., за -10м, на 2м",
                                "dstid": "ATM-AIR-HUMD-EM010MP002M",
                                "name": "Относительная влажность воздуха, среднее, за -10мин, на высоте 2м",
                                "uid": "1-02-47"
                            }
                        ]
                    },
                    "name": "Относительная влажность воздуха",
                    "oid": "ATM-AIR-HUMD"
                },
                {
                    "dstypes": {
                        "count": 5,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SRC"
                                    },
                                    "per": {
                                        "k": "HOUR",
                                        "v": -3
                                    },
                                    "sig": {
                                        "k": "CHNG"
                                    }
                                },
                                "caption": "Атмосферное давление, изм., за -3ч,  от у.с.",
                                "dstid": "ATM-AIR-PRES-CM003HXSRCX",
                                "name": "Атмосферное давление, изменение, за -3час,  от уровня станции",
                                "uid": "1-02-66"
                            },
                            {
                                "attr": {
                                    "height": {
                                        "b": "SEA"
                                    },
                                    "per": {
                                        "k": "MIN",
                                        "v": -10
                                    },
                                    "sig": {
                                        "k": "MEAN"
                                    }
                                },
                                "caption": "Атмосферное давление, ср., за -10м,  от у.м.",
                                "dstid": "ATM-AIR-PRES-EM010MXSEAX",
                                "name": "Атмосферное давление, среднее, за -10мин,  от уровня моря",
                                "uid": "1-02-66"
                            },
                            {
                                "attr": {
                                    "height": {
                                        "b": "SRC"
                                    },
                                    "per": {
                                        "k": "MIN",
                                        "v": -10
                                    },
                                    "sig": {
                                        "k": "MEAN"
                                    }
                                },
                                "caption": "Атмосферное давление, ср., за -10м,  от у.с.",
                                "dstid": "ATM-AIR-PRES-EM010MXSRCX",
                                "name": "Атмосферное давление, среднее, за -10мин,  от уровня станции",
                                "uid": "1-02-66"
                            },
                            {
                                "attr": {
                                    "height": {
                                        "b": "SEA"
                                    },
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Атмосферное давление, мгн.,  от у.м.",
                                "dstid": "ATM-AIR-PRES-IXXXXXXSEAX",
                                "name": "Атмосферное давление, мгновенное,  от уровня моря",
                                "uid": "1-02-66"
                            },
                            {
                                "attr": {
                                    "height": {
                                        "b": "SRC"
                                    },
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Атмосферное давление, мгн.,  от у.с.",
                                "dstid": "ATM-AIR-PRES-IXXXXXXSRCX",
                                "name": "Атмосферное давление, мгновенное,  от уровня станции",
                                "uid": "1-02-66"
                            }
                        ]
                    },
                    "name": "Атмосферное давление",
                    "oid": "ATM-AIR-PRES"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {},
                                "caption": "Дайджест-ряд",
                                "dstid": "GRP-DIG-DATA-XXXXXXXXXXX",
                                "name": "Дайджест-ряд"
                            }
                        ]
                    },
                    "name": "Дайджест-ряд",
                    "oid": "GRP-DIG-DATA"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {},
                                "caption": "Ряд  КН-01",
                                "dstid": "GRP-TAC-OC01-XXXXXXXXXXX",
                                "name": "Ряд сводок КН-01"
                            }
                        ]
                    },
                    "name": "Ряд сводок КН-01",
                    "oid": "GRP-TAC-OC01"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {},
                                "caption": "Ряд CommonXML",
                                "dstid": "GRP-XML-COMN-XXXXXXXXXXX",
                                "name": "Ряд сводок CommonXML"
                            }
                        ]
                    },
                    "name": "Ряд сводок CommonXML",
                    "oid": "GRP-XML-COMN"
                }
            ],
            "sid": "RU77-027518-0000"
        }
    }
}

```

**Возможные поля наблюдения**:

| **имя поля** | **тип**  | **описание**                        |
|--------------|----------|-------------------------------------|
| `oid`        | `string` | уникальный идентификатор наблюдения |
| `dstid`      | `string` | уникальный идентификатор типа ряда  |
| `name`       | `string` | название наблюдения или типа ряда   |
| `caption`    | `string` | сокращенное название типа ряда      |
| `attr`       | `json`   | аттрибуты типа ряда                 |
| `uuid`       | `string` | идентификатор единицы измерения     |
| `sid`        | `string` | идентификатор источника             |

**Пример:**  `/api/v2/sources/RU77-027518-0000/observations?dataseries=true&flag=lastdata,state`

**Ответ:** :

```json
{
    "meta": {
    },
    "response": {
        "observations": {
            "count": 25,
            "items": [
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Температура точки росы, мгн., на 2м",
                                "dataseries": {
                                    "count": 2,
                                    "items": [
                                        {
                                            "created": 1760454772,
                                            "dsid": "40db4669-a910-11f0-b731-02420a00015e",
                                            "lastData": null,
                                            "last_insert": 1761923537,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1761923537
                                            },
                                            "updated": 1760454772
                                        },
                                        {
                                            "created": 1760454863,
                                            "dsid": "7712b062-a910-11f0-b731-02420a00015e",
                                            "lastData": null,
                                            "last_insert": 1761923817,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1761923817
                                            },
                                            "updated": 1760454863
                                        }
                                    ]
                                },
                                "dstid": "ATM-AIR-DWPT-IXXXXXP002M",
                                "name": "Температура точки росы, мгновенное, на высоте 2м",
                                "uid": "1-02-23"
                            }
                        ]
                    },
                    "name": "Температура точки росы",
                    "oid": "ATM-AIR-DWPT"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {},
                                "caption": "Дайджест-ряд",
                                "dataseries": {
                                    "count": 4,
                                    "items": [
                                        {
                                            "created": 1760446742,
                                            "dsid": "8ed643a7-a8fd-11f0-b731-02420a00015e",
                                            "lastData": {
                                                "cv": {
                                                    "dsids": [
                                                        "8ed6438d-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643cb-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64303-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643b2-a8fd-11f0-b731-02420a00015e",
                                                        "8ed6434d-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64387-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643b7-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64347-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64393-a8fd-11f0-b731-02420a00015e",
                                                        "8ed6433c-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64342-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64310-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643ad-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643c7-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64358-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64399-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643a7-a8fd-11f0-b731-02420a00015e",
                                                        "8ed6430a-a8fd-11f0-b731-02420a00015e",
                                                        "35b21dc4-c451-11f0-8120-02420a000151",
                                                        "8ed643c2-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643d9-a8fd-11f0-b731-02420a00015e",
                                                        "8ed6435e-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64371-a8fd-11f0-b731-02420a00015e",
                                                        "8ed642ec-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64363-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64315-a8fd-11f0-b731-02420a00015e",
                                                        "8ed643bc-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64382-a8fd-11f0-b731-02420a00015e",
                                                        "8ed642fe-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64376-a8fd-11f0-b731-02420a00015e",
                                                        "8ed64352-a8fd-11f0-b731-02420a00015e",
                                                        "8ed6437b-a8fd-11f0-b731-02420a00015e"
                                                    ]
                                                },
                                                "dt": 1763730610,
                                                "fmt": 1763730600,
                                                "havecv": true,
                                                "v": null
                                            },
                                            "last_insert": 1763730892,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1763730892
                                            },
                                            "updated": 1760446742
                                        },
                                        {
                                            "created": 1760446691,
                                            "dsid": "70402153-a8fd-11f0-b731-02420a00015e",
                                            "lastData": {
                                                "cv": {
                                                    "dsids": [
                                                        "7040214e-a8fd-11f0-b731-02420a00015e"
                                                    ]
                                                },
                                                "dt": 1763752210,
                                                "fmt": 1763752200,
                                                "havecv": true,
                                                "jrid": "cb3ddc6b-c70d-11f0-9994-02420a000199",
                                                "v": null
                                            },
                                            "last_insert": 1763752262,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1763752262
                                            },
                                            "updated": 1760446691
                                        },
                                        {
                                            "created": 1760446691,
                                            "dsid": "703045f5-a8fd-11f0-b731-02420a00015e",
                                            "lastData": {
                                                "cv": {
                                                    "dsids": [
                                                        "703045ec-a8fd-11f0-b731-02420a00015e",
                                                        "70304602-a8fd-11f0-b731-02420a00015e",
                                                        "70304607-a8fd-11f0-b731-02420a00015e",
                                                        "70304610-a8fd-11f0-b731-02420a00015e",
                                                        "703045fa-a8fd-11f0-b731-02420a00015e",
                                                        "703045fc-a8fd-11f0-b731-02420a00015e",
                                                        "703045fd-a8fd-11f0-b731-02420a00015e",
                                                        "70304600-a8fd-11f0-b731-02420a00015e",
                                                        "7030460b-a8fd-11f0-b731-02420a00015e",
                                                        "703045f6-a8fd-11f0-b731-02420a00015e",
                                                        "703045e3-a8fd-11f0-b731-02420a00015e",
                                                        "70304609-a8fd-11f0-b731-02420a00015e",
                                                        "703045ef-a8fd-11f0-b731-02420a00015e",
                                                        "703045f1-a8fd-11f0-b731-02420a00015e",
                                                        "703045f3-a8fd-11f0-b731-02420a00015e",
                                                        "703045ea-a8fd-11f0-b731-02420a00015e",
                                                        "703045da-a8fd-11f0-b731-02420a00015e",
                                                        "703045e6-a8fd-11f0-b731-02420a00015e",
                                                        "7040214e-a8fd-11f0-b731-02420a00015e",
                                                        "703045e1-a8fd-11f0-b731-02420a00015e",
                                                        "7030460c-a8fd-11f0-b731-02420a00015e",
                                                        "703045df-a8fd-11f0-b731-02420a00015e",
                                                        "703045ed-a8fd-11f0-b731-02420a00015e",
                                                        "70304604-a8fd-11f0-b731-02420a00015e",
                                                        "703045e5-a8fd-11f0-b731-02420a00015e",
                                                        "70304606-a8fd-11f0-b731-02420a00015e",
                                                        "703045e8-a8fd-11f0-b731-02420a00015e",
                                                        "703045ff-a8fd-11f0-b731-02420a00015e",
                                                        "703045f8-a8fd-11f0-b731-02420a00015e",
                                                        "7030460e-a8fd-11f0-b731-02420a00015e",
                                                        "b8d53d90-c161-11f0-8120-02420a000151"
                                                    ]
                                                },
                                                "dt": 1763752210,
                                                "fmt": 1763752200,
                                                "havecv": true,
                                                "jrid": "cb3ddc6b-c70d-11f0-9994-02420a000199",
                                                "v": null
                                            },
                                            "last_insert": 1763752262,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1763752262
                                            },
                                            "updated": 1760446691
                                        },
                                        {
                                            "created": 1760454772,
                                            "dsid": "40db4660-a910-11f0-b731-02420a00015e",
                                            "lastData": null,
                                            "last_insert": 1761923537,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1761923537
                                            },
                                            "updated": 1760454772
                                        }
                                    ]
                                },
                                "dstid": "GRP-DIG-DATA-XXXXXXXXXXX",
                                "name": "Дайджест-ряд"
                            }
                        ]
                    },
                    "name": "Дайджест-ряд",
                    "oid": "GRP-DIG-DATA"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {},
                                "caption": "Ряд  КН-01",
                                "dataseries": {
                                    "count": 2,
                                    "items": [
                                        {
                                            "created": 1760454863,
                                            "dsid": "7712b067-a910-11f0-b731-02420a00015e",
                                            "lastData": null,
                                            "last_insert": 1761923817,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1761923817
                                            },
                                            "updated": 1760454863
                                        },
                                        {
                                            "created": 1760454772,
                                            "dsid": "40db4665-a910-11f0-b731-02420a00015e",
                                            "lastData": null,
                                            "last_insert": 1761923537,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1761923537
                                            },
                                            "updated": 1760454772
                                        }
                                    ]
                                },
                                "dstid": "GRP-TAC-OC01-XXXXXXXXXXX",
                                "name": "Ряд сводок КН-01"
                            }
                        ]
                    },
                    "name": "Ряд сводок КН-01",
                    "oid": "GRP-TAC-OC01"
                },
                {
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {},
                                "caption": "Ряд CommonXML",
                                "dataseries": {
                                    "count": 2,
                                    "items": [
                                        {
                                            "created": 1760446742,
                                            "dsid": "8ed6437b-a8fd-11f0-b731-02420a00015e",
                                            "lastData": {
                                                "cv": null,
                                                "dt": 1763730610,
                                                "fmt": 1763730600,
                                                "havecv": true,
                                                "v": null
                                            },
                                            "last_insert": 1763730892,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1763730892
                                            },
                                            "updated": 1760446742
                                        },
                                        {
                                            "created": 1760446691,
                                            "dsid": "703045ea-a8fd-11f0-b731-02420a00015e",
                                            "lastData": {
                                                "cv": null,
                                                "dt": 1763752210,
                                                "fmt": 1763752200,
                                                "havecv": true,
                                                "jrid": "cb3ddc6b-c70d-11f0-9994-02420a000199",
                                                "v": null
                                            },
                                            "last_insert": 1763752262,
                                            "mid": null,
                                            "state": {
                                                "color": "green",
                                                "dt": 1763752262
                                            },
                                            "updated": 1760446691
                                        }
                                    ]
                                },
                                "dstid": "GRP-XML-COMN-XXXXXXXXXXX",
                                "name": "Ряд сводок CommonXML"
                            }
                        ]
                    },
                    "name": "Ряд сводок CommonXML",
                    "oid": "GRP-XML-COMN"
                }
            ],
            "sid": "RU77-027518-0000"
        }
    }
}
```

**Возможные поля**:

| **имя поля** | **тип**  | **описание**                        |
|--------------|----------|-------------------------------------|
| `oid`        | `string` | уникальный идентификатор наблюдения |
| `dstid`      | `string` | уникальный идентификатор типа ряда  |
| `name`       | `string` | название наблюдения или типа ряда   |
| `caption`    | `string` | сокращенное название типа ряда      |
| `attr`       | `json`   | аттрибуты типа ряда                 |
| `uuid`       | `string` | идентификатор единицы измерения     |
| `sid`        | `string` | идентификатор источника             |
| `dsid`       | `uuid`   | уникальный идентификатор ряда                               |
| `last_insert`  | `unixtime` | время последней вставки данных в ряд                        |
| `lastData`     | `json`     | описание последней точки ряда                               |
| `state`        | `object`   | описание состояния ряда                                     |
| `state.color`  | `string`   | цвет ряда (**green, grey, orange, red**)                    |
| `state.dt`     | `unixtime` | время обновления состояния                                  |
| `state.reason` | `array`    | массив причин (строк i18n) для обновленения состояния       |


