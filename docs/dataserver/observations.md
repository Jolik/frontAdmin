# Ресурс "Наблюдения" (observations)

## 1. Список наблюдений

**Назначение:** Для получения списка наблюдений, что зарегистрированы в сервере. 

Указывая какой-либо из параметров, сервер найдет по нему наблюдения и выдаст в ответе эти наблюдения со списком типов рядов.

**Запрос** `/api/v2/observations/list`

**Тип запроса:** GET

**Возможный параметр**:

| **имя поля** | **тип**   | **описание**                                                                                                                                                                                                                                                                                                                                                            |
|--------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `page`       | `integer` | текущая страница для отображения                                                                                                                                                                                                                                                                                                                                        |
| `pagesize`   | `integer` | кол-во элементов на странице для отображения. По умолчанию pagesize = 100                                                                                                                                                                                                                                                                                               |
| `sid`        | `[]string` | список источников                                                                                                                                                                                                                                                                                                                                                       |
| `oid`        | `[]string` | список идентификаторов наблюдения                                                                                                                                                                                                                                                                                                                                       |
| `dstid`      | `[]string` | список идентификатор типа ряда                                                                                                                                                                                                                                                                                                                                          |
| `sig`        | `string`   | значимость измерения. Возможные значения: **MAX, MIN, AVG**                                                                                                                                                                                                                                                                                                             |
| `per`        |          | период измерения                                                                                                                                                                                                                                                                                                                                                        |
| `pkind`      |          | тип периода измерения                                                                                                                                                                                                                                                                                                                                                   |
| `dis`        |          | дискретность измерения                                                                                                                                                                                                                                                                                                                                                  |
| `dkind`      |          | тип дискретности измерения                                                                                                                                                                                                                                                                                                                                              |
| `height`     |          | высота производства измерения                                                                                                                                                                                                                                                                                                                                           |
| `hkind`      |          | тип измерения высоты                                                                                                                                                                                                                                                                                                                                                    |
| `flags`      |          | флаги поиска рядов. Могут быть следующих вариантов:                                                                                                                                                                                                                                                                                                                     |
| `-strict`     | -opt     | требуется строгое соответствие. Если не указан этот флаг, то в ответ выводятся также типы рядов, у которых соответствующие поля = nil. Например, в запросе указано sig = MAX. В случае, если указан флаг strict, то в ответ могут попасть только ряды у которых поле sig = MAX. Если флаг strict не указан, то в ответ попадают ряды у которых поле sig = MAX или NULL. |

**Ответ:** :

```json

{
    "meta": {},
    "response": {
        "observations": {
            "count": 100,
            "info": {
                "page": 1,
                "pagecount": 3,
                "pagesize": 100,
                "total": 209
            },
            "items": [
                {
                    "caption": "Опасн. агромет. явления",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SRC"
                                    },
                                    "sig": {
                                        "k": "LIST"
                                    }
                                },
                                "caption": "Опасные агрометеорологические явления",
                                "dstid": "AGR-PHN-LIST-LXXXXXXSRCX",
                                "name": "Опасные агрометеорологические явления"
                            }
                        ]
                    },
                    "name": "Опасные агрометеорологические явления",
                    "oid": "AGR-PHN-LIST"
                },
                {
                    "caption": "Оповещения MeteoAlarmCAP",
                    "name": "Оповещения о явлениях MeteoAlarmCAP",
                    "oid": "ALR-CAP-LIST"
                },
                {
                    "caption": "Данные зонда ур. макс. ветра",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования с уровня максимального ветра",
                                "dstid": "ATM-AER-MXWL-IXXXXXXXXXX",
                                "name": "Данные зондирования с уровня максимального ветра"
                            }
                        ]
                    },
                    "name": "Данные зондирования с уровня максимального ветра",
                    "oid": "ATM-AER-MXWL"
                },
                {
                    "caption": "Данные зонда ур. поверхности",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования с уровня поверхности",
                                "dstid": "ATM-AER-SRFC-IXXXXXXXXXX",
                                "name": "Данные зондирования с уровня поверхности"
                            }
                        ]
                    },
                    "name": "Данные зондирования с уровня поверхности",
                    "oid": "ATM-AER-SRFC"
                },
                {
                    "caption": "Данные зонда ур. ст.изоб.пов-ти",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования с уровня стандартной изобарической поверхности",
                                "dstid": "ATM-AER-STDL-IXXXXXXXXXX",
                                "name": "Данные зондирования с уровня стандартной изобарической поверхности"
                            }
                        ]
                    },
                    "name": "Данные зондирования с уровня стандартной изобарической поверхности",
                    "oid": "ATM-AER-STDL"
                },
                {
                    "caption": "Данные зонда ур. особ.т.тмп-вл.",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования с уровня особой точки температуры и влажности",
                                "dstid": "ATM-AER-STPL-IXXXXXXXXXX",
                                "name": "Данные зондирования с уровня особой точки температуры и влажности"
                            }
                        ]
                    },
                    "name": "Данные зондирования с уровня особой точки температуры и влажности",
                    "oid": "ATM-AER-STPL"
                },
                {
                    "caption": "Данные зонда ур. особ.т.ветра",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования с уровня особой точки ветра",
                                "dstid": "ATM-AER-SWDL-IXXXXXXXXXX",
                                "name": "Данные зондирования с уровня особой точки ветра"
                            }
                        ]
                    },
                    "name": "Данные зондирования с уровня особой точки ветра",
                    "oid": "ATM-AER-SWDL"
                },
                {
                    "caption": "Данные зонда со всех точек",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования со всех точек",
                                "dstid": "ATM-AER-TRAC-IXXXXXXXXXX",
                                "name": "Данные зондирования со всех точек"
                            }
                        ]
                    },
                    "name": "Данные зондирования со всех точек",
                    "oid": "ATM-AER-TRAC"
                },
                {
                    "caption": "Данные зонда с уровня тропопаузы",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Данные зондирования с уровня тропопаузы",
                                "dstid": "ATM-AER-TRPL-IXXXXXXXXXX",
                                "name": "Данные зондирования с уровня тропопаузы"
                            }
                        ]
                    },
                    "name": "Данные зондирования с уровня тропопаузы",
                    "oid": "ATM-AER-TRPL"
                },
                {
                    "caption": "CAVOK",
                    "dstypes": {
                        "count": 1,
                        "items": [
                            {
                                "attr": {
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Наличие условий CAVOK",
                                "dstid": "ATM-AIR-CAVK-IXXXXXXXXXX",
                                "name": "Наличие условий CAVOK"
                            }
                        ]
                    },
                    "name": "Наличие условий CAVOK",
                    "oid": "ATM-AIR-CAVK"
                },
                {
                    "caption": "Дефицит влажности воздуха",
                    "dstypes": {
                        "count": 2,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "per": {
                                        "k": "HOUR",
                                        "v": -24
                                    },
                                    "sig": {
                                        "k": "MEAN"
                                    }
                                },
                                "caption": "Дефицит насыщения воздуха водяным паром на 2м",
                                "dstid": "ATM-AIR-DFSA-EM024HP002M",
                                "name": "Дефицит насыщения воздуха водяным паром, средний за 24 часа, на высоте 2 м",
                                "uid": "1-02-66"
                            },
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "per": {
                                        "k": "HOUR",
                                        "v": -24
                                    },
                                    "sig": {
                                        "k": "MAX"
                                    }
                                },
                                "caption": "Дефицит насыщения воздуха водяным паром на 2м",
                                "dstid": "ATM-AIR-DFSA-MM024HP002M",
                                "name": "Дефицит насыщения воздуха водяным паром, максимальный за 24 часа, на высоте 2 м",
                                "uid": "1-02-66"
                            }
                        ]
                    },
                    "name": "Дефицит насыщения воздуха водяным паром",
                    "oid": "ATM-AIR-DFSA",
                    "uid": "1-02-66"
                },
                {
                    "caption": "Дефицит точки росы",
                    "name": "Дефицит точки росы",
                    "oid": "ATM-AIR-DWPD",
                    "uid": "1-02-23"
                },
                {
                    "caption": "Температура точки росы",
                    "dstypes": {
                        "count": 2,
                        "items": [
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "per": {
                                        "k": "MIN",
                                        "v": -10
                                    },
                                    "sig": {
                                        "k": "MEAN"
                                    }
                                },
                                "caption": "Температура точки росы на 2м",
                                "dstid": "ATM-AIR-DWPT-EM010MP002M",
                                "name": "Температура точки росы, средняя за 10 минут, на высоте 2м",
                                "uid": "1-02-23"
                            },
                            {
                                "attr": {
                                    "height": {
                                        "b": "SFC",
                                        "k": "M",
                                        "v": 2
                                    },
                                    "sig": {
                                        "k": "INS"
                                    }
                                },
                                "caption": "Температура точки росы на 2м",
                                "dstid": "ATM-AIR-DWPT-IXXXXXP002M",
                                "name": "Температура точки росы, мгновенная, на высоте 2м",
                                "uid": "1-02-23"
                            }
                        ]
                    },
                    "name": "Температура точки росы",
                    "oid": "ATM-AIR-DWPT",
                    "uid": "1-02-23"
                }
      ]
    }
  }
}

```

**Возможные поля наблюдения**:

| **имя поля** | **тип**  | **описание**                        |
|--------------|----------|-------------------------------------|
| `oid`        | `string` | уникальный идентификатор наблюдения |
| `uid`        | `string` | единица измерения |
| `name`       | `string` | название наблюдения или типа ряда   |
| `dstypes`    | `json` | объект со списком рядов  |
| `dstypes.count`  | `integer` | количество типов рядов   |
| `dstypes.items`  | `[]json]` | массив типов рядов    |
| `dstid`      | `string` | уникальный идентификатор типа ряда  |
| `caption`    | `string` | сокращенное название типа ряда      |
| `main`       | `bool`   | главный типа ряда                   |

Поле `main` (главный тип ряда) вводили чтобы отмечать тот тип ряда, который является основым для данного типа
наблюдений. Например, для типа наблюдений "температура воздуха" главным является тип ряда "температура воздуха на высоте
2м"

## 2.Информация по указанному наблюдению

**Назначение:** для получения полной информации по идентификатору наблюдения

**Запрос** `/api/v2/observations/OBS_ID`

**Тип запроса:** GET

**Пример:**   `/api/v2/observations/ATM-TMP-AIRT-001`

**Ответ:** :

```json

{
    "meta": { },
    "response": {
        "observation": {
            "caption": "Дефицит влажности воздуха",
            "dstypes": {
                "count": 2,
                "items": [
                    {
                        "attr": {
                            "height": {
                                "b": "SFC",
                                "k": "M",
                                "v": 2
                            },
                            "per": {
                                "k": "HOUR",
                                "v": -24
                            },
                            "sig": {
                                "k": "MEAN"
                            }
                        },
                        "caption": "Дефицит насыщения воздуха водяным паром на 2м",
                        "dstid": "ATM-AIR-DFSA-EM024HP002M",
                        "name": "Дефицит насыщения воздуха водяным паром, средний за 24 часа, на высоте 2 м"
                    },
                    {
                        "attr": {
                            "height": {
                                "b": "SFC",
                                "k": "M",
                                "v": 2
                            },
                            "per": {
                                "k": "HOUR",
                                "v": -24
                            },
                            "sig": {
                                "k": "MAX"
                            }
                        },
                        "caption": "Дефицит насыщения воздуха водяным паром на 2м",
                        "dstid": "ATM-AIR-DFSA-MM024HP002M",
                        "name": "Дефицит насыщения воздуха водяным паром, максимальный за 24 часа, на высоте 2 м"
                    }
                ]
            },
            "name": "Дефицит насыщения воздуха водяным паром",
            "oid": "ATM-AIR-DFSA",
            "uid": "1-02-66"
        }
    }
}

```

**Возможные поля наблюдения**:

| **имя поля** | **тип**  | **описание**                                                      |
|--------------|----------|-------------------------------------------------------------------|
| `oid`        | `string` | уникальный идентификатор наблюдения                               |
| `name `      | `string` | название наблюдения                                               |
| `caption`    | `string` | сокращенное название наблюдения                                   |
| `dstypes`    | `json` | объект со списком рядов  |
| `dstypes.count`  | `integer` | количество типов рядов   |
| `dstypes.items`  | `[]json]` | массив типов рядов    |

## 3.Информация по указанному типу ряда

**Назначение:** для получения полной информации по идентификатору наблюдения

**Запрос** `/api/v2/observations/dstypes/DST_ID`
где `DST_ID` - уникальный идентификатор типа ряда

**Тип запроса:** GET

**Пример:**   `/api/v2/observations/dstypes/ATM-PRS-IXXXXXXXM02`

**Ответ:** :

```json

{
    "meta": {},
    "response": {
        "dstype": {
            "attr": {
                "height": {
                    "b": "SFC",
                    "k": "M",
                    "v": 2
                },
                "per": {
                    "k": "MIN",
                    "v": -10
                },
                "sig": {
                    "k": "MEAN"
                }
            },
            "caption": "Температура точки росы, ср., за -10м, на 2м",
            "dstid": "ATM-AIR-DWPT-EM010MP002M",
            "name": "Температура точки росы, среднее, за -10мин, на высоте 2м",
            "uid": "1-02-23"
        }
    }
}

```

**Возможные поля ответа**:

| **имя поля** | **тип**  | **описание**                        |
|--------------|----------|-------------------------------------|
| `dstype`     | `json` | объект с описание типа ряда  |
| `dstid `     | `string` | уникальный идентификатор типа ряда  |
| `name`       | `string` | название типа ряда                  |
| `caption`    | `string` | сокращенное название типа ряда      |
| `uid`        | `string` | единица измерения |
| `attr`       | `json`   | атрибуты измерения |

